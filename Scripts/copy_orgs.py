# -*- coding: utf-8 -*-
"""
Created on Wed Jun 11 13:42:49 2014

@author: pczrr
"""
import MySQLdb as mdb

def connect_to_mysqldb():
    connection = mdb.connect(host=host,db=db,user=un)
    cursor=connection.cursor()
    return connection,cursor
    
def write_fasta(header,sequence):
    with open('/tmp/refDnaGs','a') as fout:
        print '>' + header + '\n' + sequence +'\n'
        fout.write('>' + header + '\n' + sequence +'\n')

orglist=['83333','243159','397945','688245','331272','380358','936156','224308','720555',
'1001582','420246','521098','866775','645463','272562','357809','264732','289376','330214',
'667014','795359','926550','383372','357808','326427','324602','309801','479434','525904',
'926569','522772','768670','717231','639282','653733','262724','869210','670487','649638',
'504728','709986','546414','243230','319795','693977','515635','511051','379066','266117',
'580340','891968','525903','572547','660470','521045','688269','390874','309803','484019',
'771875','381764','403833','443254','298653','326424','446469','471856','455632','526225',
'262316','196164','190304','526218','523794','572544','65393','110662','74547','59920',
'167542','269084','551115','251221','981222','682795','696844','401053','926566','240015',
'204669','234267','63186','313603','402612','376686','926562','866536','693979','435590',
'435591','767031','324925','290315','340177','290317','319225','290318','194439','290512',
'517418','502025','1162668','471821','445932','1142394','638303','608538','224324','380749',
'204536','436114','123214','868864','648996','243164','760011','158189','158190','889378',
'906968','545694','246197','521674','756272','575540','530564','243090','945713','331113',
'716544','264201','765952','272561','218497','83558','331635','441768','482235','390236',
'412419','452637','583355','526224','59374','438753','272630','317655','267748','272635',
'872331','262722','862259','340047','521095','481448','355276','226900','519441','349741',
'272633','565575','203124','32049','985002']

host='localhost'
db='FamilyCpolymerases'
un='sequser'

connection,cursor=connect_to_mysqldb()
sql="select concat(OrganismID,'|',Accession_Number), Sequence from DnaGs where (PolGroup like 'refDnaG' and OrganismID = '{}')"
for org in orglist:
    cursor.execute(sql.format(org))
    entry = cursor.fetchall()
    try:    
        header=entry[0][0]
        sequence=entry[0][1]
    except IndexError, e:
        print e
        continue
    write_fasta(header,sequence)
connection.close()